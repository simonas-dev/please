#!/usr/bin/env ruby

require_relative '../lib/ollama_wrapper'
require_relative '../version'

def show_usage
  puts <<~USAGE
    Please v#{PleaseConsts::VERSION} - Ollama prompt runner with built-in prompts
    
    Usage:
      please <alias_name> [additional_args...]     - Run a prompt alias
      pls list                                     - List all available aliases
      pls help                                     - Show this help
    
    Examples:
      pls lastCommitScope                          - Run the scope of impact analysis
      pls list                                     - Show all available prompt aliases
  USAGE
end

if ARGV.empty? || ARGV[0] == 'help' || ARGV[0] == '--help' || ARGV[0] == '-h'
  show_usage
  exit 0
end

wrapper = OllamaWrapper.new

case ARGV[0]
when 'list'
  wrapper.list_aliases
else
  # Run the specified alias with any additional arguments
  alias_name = ARGV[0]
  additional_args = ARGV[1..-1] || []
  
  unless wrapper.run(alias_name, *additional_args)
    exit 1
  end
end